<div class="form-container">
@if (resetForm) {
  <form [formGroup]="resetForm" (ngSubmit)="onSubmit()">
    <h2>Reset Password</h2>
    <p>Enter the code sent to your email and choose a new password.</p>

    <fieldset>
      <label for="email">Email</label>
      <input type="email" id="email" formControlName="email" [readOnly]="true">
    </fieldset>

    <fieldset>
      <label for="code">Verification Code</label>
      <input type="text" id="code" formControlName="code" autofocus>
      @if (resetForm.get('code')?.invalid && resetForm.get('code')?.touched) {
        <p class="validation-error">Code is required.</p>
      }
    </fieldset>

    <fieldset>
      <label for="newPassword">New Password</label>
      <input type="password" id="newPassword" formControlName="newPassword">
      @if (resetForm.get('newPassword')?.invalid && resetForm.get('newPassword')?.touched) {
        <p class="validation-error">Must be at least 8 characters.</p>
      }
    </fieldset>

    <fieldset>
      <label for="confirmPassword">Confirm New Password</label>
      <input type="password" id="confirmPassword" formControlName="confirmPassword">
      @if (resetForm.hasError('passwordMismatch') && resetForm.get('confirmPassword')?.touched) {
        <p class="validation-error">Passwords do not match.</p>
      }
    </fieldset>

    @if (errorMessage) { <p class="error-message">{{ errorMessage }}</p> }

    <button type="submit" [disabled]="resetForm.invalid">Save New Password</button>
  </form>
  } @else {
    <p>Loading form...</p>
  }
</div>